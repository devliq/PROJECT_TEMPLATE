echo "üìù Validating commit message format..."

# Basic commit message validation
commit_msg=$(cat $1)

# Check if commit message is not empty (allow empty for empty commits)
if [ -z "$commit_msg" ] && [ -n "$(git diff --cached --name-only)" ]; then
    echo "‚ùå Commit message cannot be empty"
    exit 1
elif [ -z "$commit_msg" ]; then
    echo "‚ÑπÔ∏è  Empty commit message allowed for empty commit"
fi

# Check minimum length (skip for empty commits)
if [ ${#commit_msg} -lt 10 ] && [ -n "$(git diff --cached --name-only)" ]; then
    echo "‚ùå Commit message is too short (minimum 10 characters)"
    exit 1
elif [ ${#commit_msg} -lt 10 ]; then
    echo "‚ÑπÔ∏è  Short commit message allowed for empty commit"
fi

# Check for conventional commit format (optional but recommended)
if echo "$commit_msg" | grep -qE "^(feat|fix|docs|style|refactor|test|chore|perf|ci|build|revert)(\(.+\))?: .{1,}"; then
    echo "‚úÖ Commit message follows conventional format"
else
    echo "‚ÑπÔ∏è  Consider using conventional commit format:"
    echo "   feat: add new feature"
    echo "   fix: bug fix"
    echo "   docs: documentation changes"
    echo "   style: code style changes"
    echo "   refactor: code refactoring"
    echo "   test: testing related changes"
    echo "   chore: maintenance tasks"
fi

echo "‚úÖ Commit message validation passed!"